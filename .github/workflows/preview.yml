# .github/workflows/preview.yml
name: Deploy PR previews

on:
    pull_request:
        types:
            - opened
            - reopened
            - synchronize
            - closed

concurrency: preview-${{ github.ref }}

jobs:
    deploy-preview:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name: Install and Build
              if: github.event.action != 'closed' # We don't need the build if we know the preview will be removed
              run: |
                  gem install jekyll bundler
                  bundle exec jekyll build

            - name: Deploy preview
              uses: rossjrw/pr-preview-action@v1.8.1
              with:
                  source-dir: ./build/
                  preview-branch: master
                  qr-code: true
